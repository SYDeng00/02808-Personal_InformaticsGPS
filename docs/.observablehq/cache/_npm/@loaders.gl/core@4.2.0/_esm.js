/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/@loaders.gl/core@4.2.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{resolvePath as e,isBrowser as t,registerJSModules as r,assert as n,path as o,compareArrayBuffers as s,toArrayBuffer as a,concatenateArrayBuffersAsync as i,mergeLoaderOptions as c,canParseWithWorker as u,parseWithWorker as f,concatenateArrayBuffers as l,canEncodeWithWorker as d,NodeFile as y,BlobFile as h}from"../loader-utils@4.2.0/_esm.js";export{JSONLoader,RequestScheduler,assert,concatenateArrayBuffersAsync,document,forEach,getPathPrefix,global,isBrowser,isWorker,makeLineIterator,makeNumberedLineIterator,makeTextDecoderIterator,makeTextEncoderIterator,resolvePath,self,setPathPrefix,window}from"../loader-utils@4.2.0/_esm.js";import{Log as p}from"../../@probe.gl/log@4.0.9/_esm.js";import{validateWorkerVersion as w,assert as m,processOnWorker as b}from"../worker-utils@4.2.0/_esm.js";import{isTable as g,makeBatchFromTable as x}from"../schema@4.2.0/_esm.js";const A=e=>"boolean"==typeof e,T=e=>"function"==typeof e,B=e=>null!==e&&"object"==typeof e,S=e=>B(e)&&e.constructor==={}.constructor,$=e=>B(e)&&T(e.then),R=e=>Boolean(e)&&"function"==typeof e[Symbol.iterator],k=e=>e&&"function"==typeof e[Symbol.asyncIterator],L=e=>e&&T(e.next),E=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,v=e=>"undefined"!=typeof Blob&&e instanceof Blob,I=e=>e&&"object"==typeof e&&e.isBuffer,U=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||B(e)&&T(e.tee)&&T(e.cancel)&&T(e.getReader))(e)||(e=>B(e)&&T(e.read)&&T(e.pipe)&&A(e.readable))(e),C=e=>(e=>B(e)&&T(e.abort)&&T(e.getWriter))(e)||(e=>B(e)&&T(e.end)&&T(e.write)&&A(e.writable))(e);class O extends Error{constructor(e,t){super(e),this.reason=t.reason,this.url=t.url,this.response=t.response}reason;url;response}const _=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,W=/^([-\w.]+\/[-\w.+]+)/;function M(e,t){return e.toLowerCase()===t.toLowerCase()}function F(e){const t=_.exec(e);return t?t[1]:""}const D=/\?.*/;function P(e){return e.replace(D,"")}function N(e){if(E(e)){return e.url}if(v(e)){return e.name||""}return"string"==typeof e?e:""}function j(e){if(E(e)){const t=e,r=t.headers.get("content-type")||"",n=P(t.url);return function(e){const t=W.exec(e);return t?t[1]:e}(r)||F(n)}if(v(e)){return e.type||""}return"string"==typeof e?F(e):""}async function z(e){if(E(e))return e;const t={},r=function(e){if(E(e))return e.headers["content-length"]||-1;if(v(e))return e.size;return"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);r>=0&&(t["content-length"]=String(r));const n=N(e),o=j(e);o&&(t["content-type"]=o);const s=await async function(e){const t=5;if("string"==typeof e)return`data:,${e.slice(0,t)}`;if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const r=new FileReader;r.onload=t=>e(t?.target?.result),r.readAsDataURL(t)}))}if(e instanceof ArrayBuffer){return`data:base64,${function(e){let t="";const r=new Uint8Array(e);for(let e=0;e<r.byteLength;e++)t+=String.fromCharCode(r[e]);return btoa(t)}(e.slice(0,t))}`}return null}(e);s&&(t["x-first-bytes"]=s),"string"==typeof e&&(e=(new TextEncoder).encode(e));const a=new Response(e,{headers:t});return Object.defineProperty(a,"url",{value:n}),a}async function V(e){if(!e.ok){const t=await async function(e){const t=function(e){if(e.length<50)return e;const t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}(e.url);let r=`Failed to fetch resource (${e.status}) ${e.statusText}: ${t}`;r=r.length>100?`${r.slice(0,100)}...`:r;const n={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");n.reason=t?.includes("application/json")?await e.json():e.text()}catch(e){}return new O(r,n)}(e);throw t}}async function q(t,r){if("string"==typeof t){const n=e(t);return function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(n)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(n,r):await fetch(n,r)}return await z(t)}async function H(e,t,r){e instanceof Blob||(e=new Blob([e]));const n=e.slice(t,t+r);return await async function(e){return await new Promise(((t,r)=>{const n=new FileReader;n.onload=e=>t(e?.target?.result),n.onerror=e=>r(e),n.readAsArrayBuffer(e)}))}(n)}const J=new p({id:"loaders.gl"});class G{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const K={fetch:null,mimeType:void 0,nothrow:!1,log:new class{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:t,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Q={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function X(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function Y(){const e=X();return e.globalOptions=e.globalOptions||{...K},e.globalOptions}function Z(e){const t=X(),n=Y();t.globalOptions=ne(n,e),r(e.modules)}function ee(e,t,r,n){return r=r||[],function(e,t){te(e,null,K,Q,t);for(const r of t){const n=e&&e[r.id]||{},o=r.options&&r.options[r.id]||{},s=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};te(n,r.id,o,s,t)}}(e,r=Array.isArray(r)?r:[r]),ne(t,e,n)}function te(e,t,r,n,o){const s=t||"Top level",a=t?`${t}.`:"";for(const i in e){const c=!t&&B(e[i]);if(!(i in r)&&!("baseUri"===i&&!t)&&!("workerUrl"===i&&t))if(i in n)J.warn(`${s} loader option '${a}${i}' no longer supported, use '${n[i]}'`)();else if(!c){const e=re(i,o);J.warn(`${s} loader option '${a}${i}' not recognized. ${e}`)()}}}function re(e,t){const r=e.toLowerCase();let n="";for(const o of t)for(const t in o.options){if(e===t)return`Did you mean '${o.id}.${t}'?`;const s=t.toLowerCase();(r.startsWith(s)||s.startsWith(r))&&(n=n||`Did you mean '${o.id}.${t}'?`)}return n}function ne(e,t,r){const n={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(n,r),null===n.log&&(n.log=new G),oe(n,Y()),oe(n,t),n}function oe(e,t){for(const r in t)if(r in t){const n=t[r];S(n)&&S(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}function se(e){if(!e)return!1;Array.isArray(e)&&(e=e[0]);return Array.isArray(e?.extensions)}function ae(e){let t;return n(e,"null loader"),n(se(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const ie=()=>{const e=X();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function ce(e){const t=ie();e=Array.isArray(e)?e:[e];for(const r of e){const e=ae(r);t.find((t=>e===t))||t.unshift(e)}}function ue(){X().loaderRegistry=[]}const fe=new p({id:"loaders.gl"}),le=/\.([^.]+)$/;async function de(e,t=[],r,n){if(!he(e))return null;let o=ye(e,t,{...r,nothrow:!0},n);if(o)return o;if(v(e)&&(o=ye(e=await e.slice(0,10).arrayBuffer(),t,r,n)),!o&&!r?.nothrow)throw new Error(pe(e));return o}function ye(e,t=[],r,n){if(!he(e))return null;if(t&&!Array.isArray(t))return ae(t);let o=[];t&&(o=o.concat(t)),r?.ignoreRegisteredLoaders||o.push(...ie()),function(e){for(const t of e)ae(t)}(o);const s=function(e,t,r,n){const o=N(e),s=j(e),a=P(o)||n?.url;let i=null,c="";r?.mimeType&&(i=we(t,r?.mimeType),c=`match forced by supplied MIME type ${r?.mimeType}`);i=i||function(e,t){const r=t&&le.exec(t),n=r&&r[1];return n?function(e,t){t=t.toLowerCase();for(const r of e)for(const e of r.extensions)if(e.toLowerCase()===t)return r;return null}(e,n):null}(t,a),c=c||(i?`matched url ${a}`:""),i=i||we(t,s),c=c||(i?`matched MIME type ${s}`:""),i=i||function(e,t){if(!t)return null;for(const r of e)if("string"==typeof t){if(me(t,r))return r}else if(ArrayBuffer.isView(t)){if(be(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer){if(be(t,0,r))return r}return null}(t,e),c=c||(i?`matched initial data ${ge(e)}`:""),r?.fallbackMimeType&&(i=i||we(t,r?.fallbackMimeType),c=c||(i?`matched fallback MIME type ${s}`:""));c&&fe.log(1,`selectLoader selected ${i?.name}: ${c}.`);return i}(e,o,r,n);if(!s&&!r?.nothrow)throw new Error(pe(e));return s}function he(e){return!(e instanceof Response&&204===e.status)}function pe(e){const t=N(e),r=j(e);let n="No valid loader found (";n+=t?`${o.filename(t)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const s=e?ge(e):"";return n+=s?` first bytes: "${s}"`:"first bytes: not available",n+=")",n}function we(e,t){for(const r of e){if(r.mimeTypes?.some((e=>M(t,e))))return r;if(M(t,`application/x.${r.id}`))return r}return null}function me(e,t){if(t.testText)return t.testText(e);return(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function be(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some((r=>function(e,t,r,n){if(n instanceof ArrayBuffer)return s(n,e,n.byteLength);switch(typeof n){case"function":return n(e);case"string":return n===xe(e,t,n.length);default:return!1}}(e,t,0,r)))}function ge(e,t=5){if("string"==typeof e)return e.slice(0,t);if(ArrayBuffer.isView(e))return xe(e.buffer,e.byteOffset,t);if(e instanceof ArrayBuffer){return xe(e,0,t)}return""}function xe(e,t,r){if(e.byteLength<t+r)return"";const n=new DataView(e);let o="";for(let e=0;e<r;e++)o+=String.fromCharCode(n.getUint8(t+e));return o}const Ae=262144;const Te=262144;const Be=1048576;function Se(e,r){return t?async function*(e,t){const r=e.getReader();let n;try{for(;;){const e=n||r.read();t?._streamReadAhead&&(n=r.read());const{done:o,value:s}=await e;if(o)return;yield a(s)}}catch(e){r.releaseLock()}}(e,r):async function*(e,t){for await(const t of e)yield a(t)}(e)}function $e(e,t){if("string"==typeof e)return function*(e,t){const r=t?.chunkSize||Ae;let n=0;const o=new TextEncoder;for(;n<e.length;){const t=Math.min(e.length-n,r),s=e.slice(n,n+t);n+=t,yield o.encode(s)}}(e,t);if(e instanceof ArrayBuffer)return function*(e,t={}){const{chunkSize:r=Te}=t;let n=0;for(;n<e.byteLength;){const t=Math.min(e.byteLength-n,r),o=new ArrayBuffer(t),s=new Uint8Array(e,n,t);new Uint8Array(o).set(s),n+=t,yield o}}(e,t);if(v(e))return async function*(e,t){const r=t?.chunkSize||Be;let n=0;for(;n<e.size;){const t=n+r,o=await e.slice(n,t).arrayBuffer();n=t,yield o}}(e,t);if(U(e))return Se(e,t);if(E(e)){return Se(e.body,t)}throw new Error("makeIterator")}const Re="Cannot convert supplied data type";function ke(e,t,r){if(t.text&&"string"==typeof e)return e;if(I(e)&&(e=e.buffer),e instanceof ArrayBuffer){const r=e;if(t.text&&!t.binary){return new TextDecoder("utf8").decode(r)}return r}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary){return new TextDecoder("utf8").decode(e)}let r=e.buffer;const n=e.byteLength||e.length;return 0===e.byteOffset&&n===r.byteLength||(r=r.slice(e.byteOffset,e.byteOffset+n)),r}throw new Error(Re)}async function Le(e,t){if(L(e))return e;if(E(e)){const r=e;await V(r);return $e(await r.body,t)}return v(e)||U(e)?$e(e,t):k(e)?e:function(e){if(ArrayBuffer.isView(e))return function*(){yield e.buffer}();if(e instanceof ArrayBuffer)return function*(){yield e}();if(L(e))return e;if(R(e))return e[Symbol.iterator]();throw new Error(Re)}(e)}function Ee(e,t){const r=Y(),n=e||r;return"function"==typeof n.fetch?n.fetch:B(n.fetch)?e=>q(e,n.fetch):t?.fetch?t?.fetch:q}function ve(e,t,r){if(r)return r;const n={fetch:Ee(t,e),...e};if(n.url){const e=P(n.url);n.baseUrl=e,n.queryString=function(e){const t=e.match(D);return t&&t[0]}(n.url),n.filename=o.filename(e),n.baseUrl=o.dirname(e)}return Array.isArray(n.loaders)||(n.loaders=null),n}function Ie(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...e]:e}return r&&r.length?r:void 0}async function Ue(e,t,r,n){!t||Array.isArray(t)||se(t)||(n=void 0,r=t,t=void 0),r=r||{};const o=N(e=await e),s=Ie(t,n),a=await de(e,s,r);return a?(n=ve({url:o,_parse:Ue,loaders:s},r=ee(r,a,s,o),n||null),await async function(e,t,r,n){if(w(e),r=c(e.options,r),E(t)){const e=t,{ok:r,redirected:o,status:s,statusText:a,type:i,url:c}=e,u=Object.fromEntries(e.headers.entries());n.response={headers:u,ok:r,redirected:o,status:s,statusText:a,type:i,url:c}}t=await async function(e,t,r){const n=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||n)return ke(e,t);if(v(e)&&(e=await z(e)),E(e)){const r=e;return await V(r),t.binary?await r.arrayBuffer():await r.text()}if(U(e)&&(e=$e(e,r)),R(e)||k(e))return i(e);throw new Error(Re)}(t,e,r);const o=e;if(o.parseTextSync&&"string"==typeof t)return o.parseTextSync(t,r,n);if(u(e,r))return await f(e,t,r,n,Ue);if(o.parseText&&"string"==typeof t)return await o.parseText(t,r,n);if(o.parse)return await o.parse(t,r,n);throw m(!o.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}(a,e,r,n)):null}function Ce(e,t,r,n){Array.isArray(t)||se(t)||(n=void 0,r=t,t=void 0),r=r||{};const o=Ie(t,n),s=ye(e,o,r);if(!s)return null;const a=()=>{throw new Error("parseSync called parse (which is async")};return function(e,t,r,n){if(t=ke(t,e),e.parseTextSync&&"string"==typeof t)return e.parseTextSync(t,r);if(e.parseSync&&t instanceof ArrayBuffer)return e.parseSync(t,r,n);throw new Error(`${e.name} loader: 'parseSync' not supported by this loader, use 'parse' instead. ${n.url||""}`)}(s,e,r=ee(r,s,o),n=ve({url:N(e),_parseSync:a,_parse:a,loaders:t},r,n||null))}async function Oe(e,t,r,n){const o=Array.isArray(t)?t:void 0;Array.isArray(t)||se(t)||(n=void 0,r=t,t=void 0),r=r||{};const s=N(e=await e),a=await de(e,t,r);return a?(n=ve({url:s,_parseInBatches:Oe,_parse:Ue,loaders:o},r=ee(r,a,o,s),n||null),await async function(e,t,r,n){const o=await async function(e,t,r,n){const o=await Le(t,r),s=await async function(e,t=[]){let r=e;for await(const e of t)r=e(r);return r}(o,r?.transforms||[]);if(e.parseInBatches)return e.parseInBatches(s,r,n);return async function*(e,t,r,n){const o=await i(e),s=await Ue(o,t,{...r,mimeType:t.mimeTypes[0]},n),a=function(e,t){const r=g(e)?x(e):{shape:"unknown",batchType:"data",data:e,length:Array.isArray(e)?e.length:1};return r.mimeType=t.mimeTypes[0],r}(s,t);yield a}(s,e,r,n)}(e,t,r,n);if(!r.metadata)return o;const s={shape:"metadata",batchType:"metadata",metadata:{_loader:e,_context:n},data:[],bytesUsed:0};async function*a(e){yield s,yield*e}return a(o)}(a,e,r,n)):[]}async function _e(e,t,r,n){let o,s;Array.isArray(t)||se(t)?(o=t,s=r):(o=[],s=t);const a=Ee(s);let i=e;return"string"==typeof e&&(i=await a(e)),v(e)&&(i=await a(e)),Array.isArray(o),await Ue(i,o,s)}function We(e,t,r,n){let o;Array.isArray(t)||se(t)?o=t:(r=t,o=void 0);const s=Ee(r||{});if(!Array.isArray(e))return Me(e,o,r||{},s);return e.map((e=>Me(e,o,r||{},s)))}async function Me(e,t,r,n){if("string"==typeof e){const o=e,s=await n(o);return Array.isArray(t),await Oe(s,t,r)}return Array.isArray(t),await Oe(e,t,r)}async function Fe(e,t,r){if(t.encode)return await t.encode(e,r);if(t.encodeText){const n=await t.encodeText(e,r);return(new TextEncoder).encode(n)}if(t.encodeInBatches){const n=Pe(e,t,r),o=[];for await(const e of n)o.push(e);return l(...o)}throw new Error("Writer could not encode data")}async function De(e,t,r){if(t.text&&t.encodeText)return await t.encodeText(e,r);if(t.text){const n=await Fe(e,t,r);return(new TextDecoder).decode(n)}throw new Error(`Writer ${t.name} could not encode data as text`)}function Pe(e,t,r){if(t.encodeInBatches){const n=function(e){const t=[{...e,start:0,end:e.length}];return t}(e);return t.encodeInBatches(n,r)}throw new Error("Writer could not encode data in batches")}async function Ne(e,r,n){return n={...Y(),...n},r.encodeURLtoURL?async function(e,r,n){if(t)throw new Error(`Writer ${e.name} not supported in browser`);const o=Je("input"),s=new y(o,"w");await s.write(r);const a=Je("output"),i=await He(o,a,e,n);return(await q(i)).arrayBuffer()}(r,e,n):d(r,n)?await b(r,e,n):await r.encode(e,n)}function je(e,t,r){if(t.encodeSync)return t.encodeSync(e,r);if(t.encodeTextSync)return(new TextEncoder).encode(t.encodeTextSync(e,r));throw new Error(`Writer ${t.name} could not synchronously encode data`)}async function ze(e,t,r){if(t.encodeText)return await t.encodeText(e,r);if(t.encodeTextSync)return t.encodeTextSync(e,r);if(t.text){const n=await t.encode(e,r);return(new TextDecoder).decode(n)}throw new Error(`Writer ${t.name} could not encode data as text`)}function Ve(e,t,r){if(t.encodeTextSync)return t.encodeTextSync(e,r);if(t.text&&t.encodeSync){const n=je(e,t,r);return(new TextDecoder).decode(n)}throw new Error(`Writer ${t.name} could not encode data as text`)}function qe(e,t,r){if(t.encodeInBatches){const n=function(e){const t=[{...e,start:0,end:e.length}];return t}(e);return t.encodeInBatches(n,r)}throw new Error(`Writer ${t.name} could not encode in batches`)}async function He(r,n,o,s){if(r=e(r),n=e(n),t||!o.encodeURLtoURL)throw new Error;return await o.encodeURLtoURL(r,n,s)}function Je(e){return`/tmp/${e}`}function Ge(e,t){if(globalThis.loaders.makeNodeStream)return globalThis.loaders.makeNodeStream(e,t);const r=e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]();return new ReadableStream({type:"bytes",async pull(e){try{const{done:t,value:n}=await r.next();t?e.close():e.enqueue(new Uint8Array(n))}catch(t){e.error(t)}},async cancel(){await(r?.return?.())}},{highWaterMark:2**24,...t})}const Ke="4.2.0-beta.2",Qe={dataType:null,batchType:null,name:"Null loader",id:"null",module:"core",version:Ke,worker:!0,mimeTypes:["application/x.empty"],extensions:["null"],tests:[()=>!1],options:{null:{}}},Xe={dataType:null,batchType:null,name:"Null loader",id:"null",module:"core",version:Ke,mimeTypes:["application/x.empty"],extensions:["null"],parse:async(e,t,r)=>null,parseSync:Ye,parseInBatches:async function*(e,t,r){for await(const t of e)yield null},tests:[()=>!1],options:{null:{}}};function Ye(e,t,r){return null}async function Ze(e,t,r=(()=>{}),n=(()=>{})){if(!(e=await e).ok)return e;const o=e.body;if(!o)return e;const s=e.headers.get("content-length")||0,a=s?parseInt(s):0;if(!(a>0))return e;if("undefined"==typeof ReadableStream||!o.getReader)return e;const i=new ReadableStream({async start(e){const s=o.getReader();await et(e,s,0,a,t,r,n)}});return new Response(i)}async function et(e,t,r,n,o,s,a){try{const{done:i,value:c}=await t.read();if(i)return s(),void e.close();r+=c.byteLength;o(Math.round(r/n*100),{loadedBytes:r,totalBytes:n}),e.enqueue(c),await et(e,t,r,n,o,s,a)}catch(t){e.error(t),a(t)}}class tt{_fetch;files={};lowerCaseFiles={};usedFiles={};constructor(e,t){this._fetch=t?.fetch||fetch;for(let t=0;t<e.length;++t){const r=e[t];this.files[r.name]=r,this.lowerCaseFiles[r.name.toLowerCase()]=r,this.usedFiles[r.name]=!1}this.fetch=this.fetch.bind(this)}async fetch(e,t){if(e.includes("://"))return this._fetch(e,t);const r=this.files[e];if(!r)return new Response(e,{status:400,statusText:"NOT FOUND"});const n=new Headers(t?.headers).get("Range"),o=n&&/bytes=($1)-($2)/.exec(n);if(o){const t=parseInt(o[1]),n=parseInt(o[2]),s=await r.slice(t,n).arrayBuffer(),a=new Response(s);return Object.defineProperty(a,"url",{value:e}),a}const s=new Response(r);return Object.defineProperty(s,"url",{value:e}),s}async readdir(e){const t=[];for(const e in this.files)t.push(e);return t}async stat(e,t){const r=this.files[e];if(!r)throw new Error(e);return{size:r.size}}async unlink(e){delete this.files[e],delete this.lowerCaseFiles[e],this.usedFiles[e]=!0}async openReadableFile(e,t){return new h(this.files[e])}_getFile(e,t){const r=this.files[e]||this.lowerCaseFiles[e];return r&&t&&(this.usedFiles[e]=!0),r}}export{O as FetchError,Xe as NullLoader,Qe as NullWorkerLoader,tt as _BrowserFileSystem,Ze as _fetchProgress,ue as _unregisterLoaders,Ne as encode,qe as encodeInBatches,je as encodeSync,Fe as encodeTable,De as encodeTableAsText,Pe as encodeTableInBatches,ze as encodeText,Ve as encodeTextSync,He as encodeURLtoURL,q as fetchFile,Y as getLoaderOptions,k as isAsyncIterable,R as isIterable,L as isIterator,$ as isPromise,S as isPureObject,U as isReadableStream,E as isResponse,C as isWritableStream,_e as load,We as loadInBatches,$e as makeIterator,Ge as makeStream,Ue as parse,Oe as parseInBatches,Ce as parseSync,H as readArrayBuffer,ce as registerLoaders,de as selectLoader,ye as selectLoaderSync,Z as setLoaderOptions};export default null;
